<div class="px-4 sm:px-0">
  <div class="sm:flex sm:items-center mb-8">
    <div class="sm:flex-auto">
      <h2 class="text-3xl font-bold text-gray-900">Tournament Summary</h2>
      <p class="mt-2 text-sm text-gray-700">Complete tournament statistics and highlights</p>
    </div>
  </div>

  <!-- Podium Section -->
  <% if @top_fighters.any? %>
    <div class="bg-gradient-to-br from-yellow-50 to-orange-50 shadow rounded-lg p-8 mb-8">
      <h3 class="text-2xl font-bold text-gray-900 text-center mb-2">Top Fighters</h3>
      <p class="text-sm text-gray-600 text-center mb-6">Overall record (pools + brackets)</p>

      <div class="flex items-end justify-center gap-4 max-w-4xl mx-auto">
        <!-- 2nd Place -->
        <% if @top_fighters[1] %>
          <div class="flex flex-col items-center flex-1">
            <div class="bg-white rounded-lg shadow-lg p-6 w-full text-center mb-4 border-2 border-gray-400">
              <div class="text-4xl mb-2">ðŸ¥ˆ</div>
              <h4 class="text-lg font-bold text-gray-900"><%= @top_fighters[1].name %></h4>
              <p class="text-sm text-gray-600"><%= @top_fighters[1].club %></p>
              <div class="mt-3 pt-3 border-t border-gray-200">
                <div class="text-sm text-gray-600">Record</div>
                <div class="text-2xl font-bold text-gray-900"><%= @top_fighters[1].wins %>-<%= @top_fighters[1].losses %></div>
                <div class="text-xs text-gray-500 mt-1"><%= @top_fighters[1].points %> pts</div>
              </div>
            </div>
            <div class="bg-gray-400 rounded-t-lg w-full h-32 flex items-center justify-center">
              <span class="text-white text-6xl font-bold">2</span>
            </div>
          </div>
        <% end %>

        <!-- 1st Place -->
        <% if @top_fighters[0] %>
          <div class="flex flex-col items-center flex-1">
            <div class="bg-white rounded-lg shadow-xl p-6 w-full text-center mb-4 border-4 border-yellow-500 transform scale-110">
              <div class="text-5xl mb-2">ðŸ‘‘</div>
              <h4 class="text-xl font-bold text-yellow-700"><%= @top_fighters[0].name %></h4>
              <p class="text-sm text-yellow-600"><%= @top_fighters[0].club %></p>
              <div class="mt-3 pt-3 border-t border-yellow-200">
                <div class="text-sm text-yellow-600">Record</div>
                <div class="text-3xl font-bold text-yellow-700"><%= @top_fighters[0].wins %>-<%= @top_fighters[0].losses %></div>
                <div class="text-xs text-yellow-600 mt-1"><%= @top_fighters[0].points %> pts</div>
              </div>
            </div>
            <div class="bg-yellow-500 rounded-t-lg w-full h-48 flex items-center justify-center shadow-xl">
              <span class="text-white text-7xl font-bold">1</span>
            </div>
          </div>
        <% end %>

        <!-- 3rd Place -->
        <% if @top_fighters[2] %>
          <div class="flex flex-col items-center flex-1">
            <div class="bg-white rounded-lg shadow-lg p-6 w-full text-center mb-4 border-2 border-orange-700">
              <div class="text-4xl mb-2">ðŸ¥‰</div>
              <h4 class="text-lg font-bold text-gray-900"><%= @top_fighters[2].name %></h4>
              <p class="text-sm text-gray-600"><%= @top_fighters[2].club %></p>
              <div class="mt-3 pt-3 border-t border-gray-200">
                <div class="text-sm text-gray-600">Record</div>
                <div class="text-2xl font-bold text-gray-900"><%= @top_fighters[2].wins %>-<%= @top_fighters[2].losses %></div>
                <div class="text-xs text-gray-500 mt-1"><%= @top_fighters[2].points %> pts</div>
              </div>
            </div>
            <div class="bg-orange-700 rounded-t-lg w-full h-24 flex items-center justify-center">
              <span class="text-white text-5xl font-bold">3</span>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Tournament Stats Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    <!-- Total Matches -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0 bg-red-100 rounded-md p-3">
          <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
          </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
          <dt class="text-sm font-medium text-gray-500 truncate">Total Matches</dt>
          <dd class="text-3xl font-semibold text-gray-900"><%= @total_matches %></dd>
        </div>
      </div>
    </div>

    <!-- Total Points Scored -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0 bg-green-100 rounded-md p-3">
          <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
          </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
          <dt class="text-sm font-medium text-gray-500 truncate">Total Points Scored</dt>
          <dd class="text-3xl font-semibold text-gray-900"><%= @total_points_scored %></dd>
        </div>
      </div>
    </div>

    <!-- Average Match Duration -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0 bg-blue-100 rounded-md p-3">
          <svg class="h-6 w-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
          <dt class="text-sm font-medium text-gray-500 truncate">Avg Match Duration</dt>
          <dd class="text-3xl font-semibold text-gray-900"><%= (@average_match_duration / 60).round(1) %>m</dd>
        </div>
      </div>
    </div>
  </div>

  <!-- Highlight Stats -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <!-- Most Total Points -->
    <% if @most_total_points_fighter %>
      <div class="bg-white shadow rounded-lg p-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">Most Points Overall</h3>
        <p class="text-xs text-gray-500 mb-3">Across all matches</p>
        <div class="bg-gray-50 rounded-lg p-4 text-center">
          <div class="text-4xl font-bold text-red-600 mb-2"><%= @most_total_points_fighter.points %></div>
          <div class="text-lg font-medium text-gray-900"><%= @most_total_points_fighter.name %></div>
          <div class="text-sm text-gray-600"><%= @most_total_points_fighter.club %></div>
          <div class="mt-2 pt-2 border-t border-gray-200">
            <span class="text-xs text-gray-500">Record: <%= @most_total_points_fighter.wins %>-<%= @most_total_points_fighter.losses %></span>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Shortest Match -->
    <% if @shortest_match %>
      <div class="bg-white shadow rounded-lg p-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">Shortest Match</h3>
        <div class="bg-gray-50 rounded-lg p-4">
          <div class="text-center mb-3">
            <div class="text-4xl font-bold text-blue-600"><%= (@shortest_match.duration / 60.0).round(1) %>m</div>
            <div class="text-xs text-gray-500"><%= @shortest_match.duration %>s</div>
          </div>
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-medium text-gray-900"><%= @shortest_match.fighter1.name %></span>
            <span class="text-lg font-semibold <%= @shortest_match.winner_id == @shortest_match.fighter1_id ? 'text-green-600' : 'text-gray-500' %>">
              <%= @shortest_match.fighter1_points %>
            </span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-sm font-medium text-gray-900"><%= @shortest_match.fighter2.name %></span>
            <span class="text-lg font-semibold <%= @shortest_match.winner_id == @shortest_match.fighter2_id ? 'text-green-600' : 'text-gray-500' %>">
              <%= @shortest_match.fighter2_points %>
            </span>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Weapon Stats -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Most Used Weapons -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Most Used Weapons</h3>
      <div class="space-y-3">
        <% @most_used_weapons.each_with_index do |(weapon, count), index| %>
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <span class="text-sm font-medium text-gray-500 w-6"><%= index + 1 %>.</span>
              <span class="text-sm font-medium text-gray-900"><%= weapon.name %></span>
              <span class="ml-2 text-xs text-gray-500">(<%= weapon.weapon_type %>)</span>
            </div>
            <span class="text-sm font-semibold text-red-600"><%= count %> uses</span>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Most Used Debuffs -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Most Used Debuffs</h3>
      <div class="space-y-3">
        <% if @most_used_debuffs.any? %>
          <% @most_used_debuffs.each_with_index do |(debuff, count), index| %>
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <span class="text-sm font-medium text-gray-500 w-6"><%= index + 1 %>.</span>
                <span class="text-sm font-medium text-gray-900"><%= debuff %></span>
              </div>
              <span class="text-sm font-semibold text-red-600"><%= count %> uses</span>
            </div>
          <% end %>
        <% else %>
          <p class="text-sm text-gray-500 italic">No debuffs used yet</p>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Weapon Win Rates -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Highest Win Rate Weapons -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Highest Win Rate Weapons</h3>
      <p class="text-xs text-gray-500 mb-3">Minimum 3 uses</p>
      <div class="space-y-3">
        <% if @highest_winrate_weapons.any? %>
          <% @highest_winrate_weapons.each_with_index do |(weapon, stats), index| %>
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1">
                <span class="text-sm font-medium text-gray-500 w-6"><%= index + 1 %>.</span>
                <span class="text-sm font-medium text-gray-900 truncate"><%= weapon.name %></span>
              </div>
              <div class="flex items-center gap-2">
                <span class="text-xs text-gray-500"><%= stats[:wins] %>/<%= stats[:uses] %></span>
                <span class="text-sm font-semibold text-green-600"><%= stats[:win_rate].round(1) %>%</span>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-sm text-gray-500 italic">Not enough data yet</p>
        <% end %>
      </div>
    </div>

    <!-- Lowest Win Rate Weapons -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Lowest Win Rate Weapons</h3>
      <p class="text-xs text-gray-500 mb-3">Minimum 3 uses</p>
      <div class="space-y-3">
        <% if @lowest_winrate_weapons.any? %>
          <% @lowest_winrate_weapons.each_with_index do |(weapon, stats), index| %>
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1">
                <span class="text-sm font-medium text-gray-500 w-6"><%= index + 1 %>.</span>
                <span class="text-sm font-medium text-gray-900 truncate"><%= weapon.name %></span>
              </div>
              <div class="flex items-center gap-2">
                <span class="text-xs text-gray-500"><%= stats[:wins] %>/<%= stats[:uses] %></span>
                <span class="text-sm font-semibold text-red-600"><%= stats[:win_rate].round(1) %>%</span>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-sm text-gray-500 italic">Not enough data yet</p>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Weapon Combo Stats -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Most Successful Weapon Combos -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Most Successful Weapon Combos</h3>
      <p class="text-xs text-gray-500 mb-3">Main + Offhand (Minimum 2 uses)</p>
      <div class="space-y-4">
        <% if @most_successful_weapon_combos.any? %>
          <% @most_successful_weapon_combos.each_with_index do |(combo, stats), index| %>
            <div class="border-l-4 border-green-500 pl-3 py-2">
              <div class="flex items-center justify-between mb-1">
                <span class="text-sm font-semibold text-gray-900">#<%= index + 1 %></span>
                <div class="flex items-center gap-2">
                  <span class="text-xs text-gray-500"><%= stats[:wins] %>/<%= stats[:uses] %></span>
                  <span class="text-sm font-bold text-green-600"><%= stats[:win_rate].round(1) %>%</span>
                </div>
              </div>
              <div class="text-sm text-gray-900">
                <div><strong>Main:</strong> <%= combo[:main]&.name || 'None' %></div>
                <div><strong>Off:</strong> <%= combo[:offhand]&.name || 'None' %></div>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-sm text-gray-500 italic">Not enough data yet</p>
        <% end %>
      </div>
    </div>

    <!-- Most Successful Overall Combos -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Most Successful Overall Combos</h3>
      <p class="text-xs text-gray-500 mb-3">Main + Offhand + Debuff (Minimum 2 uses)</p>
      <div class="space-y-4">
        <% if @most_successful_overall_combos.any? %>
          <% @most_successful_overall_combos.each_with_index do |(combo, stats), index| %>
            <div class="border-l-4 border-purple-500 pl-3 py-2">
              <div class="flex items-center justify-between mb-1">
                <span class="text-sm font-semibold text-gray-900">#<%= index + 1 %></span>
                <div class="flex items-center gap-2">
                  <span class="text-xs text-gray-500"><%= stats[:wins] %>/<%= stats[:uses] %></span>
                  <span class="text-sm font-bold text-purple-600"><%= stats[:win_rate].round(1) %>%</span>
                </div>
              </div>
              <div class="text-sm text-gray-900">
                <div><strong>Main:</strong> <%= combo[:main]&.name || 'None' %></div>
                <div><strong>Off:</strong> <%= combo[:offhand]&.name || 'None' %></div>
                <div><strong>Debuff:</strong> <%= combo[:debuff] || 'None' %></div>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-sm text-gray-500 italic">Not enough data yet</p>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <% if @total_matches == 0 %>
    <div class="bg-white shadow rounded-lg p-12 text-center">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
      </svg>
      <h3 class="mt-2 text-sm font-medium text-gray-900">No Tournament Data</h3>
      <p class="mt-1 text-sm text-gray-500">Complete some matches to see tournament statistics.</p>
    </div>
  <% end %>
</div>
